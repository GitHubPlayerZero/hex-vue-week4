import{u as b,a as v,r as p,o as C,c as h,b as n,f as i,d as a,q as k,s as g,i as x,e as S,y as E,R as V,h as u,S as f}from"./index-DdYNyWda.js";import{a as B}from"./auth-BoK4Xl8z.js";const P=a("h2",{class:"formControls_txt"},"註冊帳號",-1),q=a("label",{class:"formControls_label",for:"email"},"Email",-1),D=a("label",{class:"formControls_label",for:"name"},"您的暱稱",-1),L=a("label",{class:"formControls_label",for:"pwd"},"密碼",-1),M=a("label",{class:"formControls_label",for:"repeatPwd"},"再次輸入密碼",-1),R=a("button",{type:"submit",class:"formControls_btnSubmit"},"註冊帳號",-1),N={__name:"Register",setup(T){const w=b(),d=v(),c=p("sdf4kslk3"),m=p(null),o=p({email:"aaa3@gmail.com",nickname:"ababab",password:"sdf4kslk3"});async function _(s){return s.password!==c.value?(await d.alertError("密碼不一致，請重新輸入！",{didDestroy:()=>{m.value.focus()}}),!1):!0}async function y(){const s=w.open(),{value:e}=o;if(!await _(e)){s.close();return}try{await u.postSignUp(e)}catch(r){console.error("[register] error ==>",r),await d.alertError(u.parseError(r)),s.close();return}let t;f.fire({allowEscapeKey:!1,allowOutsideClick:!1,confirmButtonText:"立即登入",showDenyButton:!0,denyButtonText:"離開",position:"top",icon:"success",title:"註冊成功！",html:'<span id="countdown">10</span> 秒後將為您自動登入，若不想登入請點擊「離開」。',timer:1e4,timerProgressBar:!0,didOpen(r){const l=r.querySelector("#countdown");t=setInterval(()=>{l.textContent=`${Math.ceil(f.getTimerLeft()/1e3)}`},1e3)},willClose(r){clearInterval(t)}}).then(async r=>{if(!r.isDenied)try{const l=await u.postSignIn(e);B.login(l.data.token)}catch(l){console.error("[login] error ==>",l),await d.alertError(u.parseError(l))}s.close()})}return(s,e)=>(C(),h("form",{class:"formControls",onSubmit:S(y,["prevent"])},[P,q,n(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.email=t),class:"formControls_input",type:"email",id:"email",name:"email",placeholder:"請輸入 email",required:""},null,512),[[i,o.value.email]]),D,n(a("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.nickname=t),class:"formControls_input",type:"text",name:"name",id:"name",placeholder:"請輸入您的暱稱",required:""},null,512),[[i,o.value.nickname]]),L,n(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.password=t),class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",required:""},null,512),[[i,o.value.password]]),M,n(a("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>c.value=t),ref_key:"refRepeatPwd",ref:m,class:"formControls_input",type:"password",name:"repeatPwd",id:"repeatPwd",placeholder:"請再次輸入密碼",required:""},null,512),[[i,c.value]]),R,k(x(V),{to:{name:"login"},class:"formControls_btnLink"},{default:g(()=>[E("登入")]),_:1})],32))}};export{N as default};
