import{u as v,a as C,r as c,o as h,c as b,b as n,f as i,d as o,q as g,s as k,i as x,e as S,y as E,R as V,h as u,S as f}from"./index-Btr8lL4W.js";import{a as B}from"./auth-BJOwzhC7.js";const P=o("h2",{class:"formControls_txt"},"註冊帳號",-1),q=o("label",{class:"formControls_label",for:"email"},"Email",-1),D=o("label",{class:"formControls_label",for:"name"},"您的暱稱",-1),L=o("label",{class:"formControls_label",for:"pwd"},"密碼",-1),M=o("label",{class:"formControls_label",for:"repeatPwd"},"再次輸入密碼",-1),R=o("button",{type:"submit",class:"formControls_btnSubmit"},"註冊帳號",-1),N={__name:"Register",setup(T){const w=v(),d=C(),p=c(""),m=c(null),r=c({email:"",nickname:"",password:""});async function _(s){return s.password!==p.value?(await d.alertError("密碼不一致，請重新輸入！",{didDestroy:()=>{m.value.focus()}}),!1):!0}async function y(){const s=w.open(),{value:e}=r;if(!await _(e)){s.close();return}try{await u.postSignUp(e)}catch(a){console.error("[register] error ==>",a),await d.alertError(u.parseError(a)),s.close();return}let t;f.fire({allowEscapeKey:!1,allowOutsideClick:!1,confirmButtonText:"立即登入",showDenyButton:!0,denyButtonText:"離開",position:"top",icon:"success",title:"註冊成功！",html:'<span id="countdown">10</span> 秒後將為您自動登入，若不想登入請點擊「離開」。',timer:1e4,timerProgressBar:!0,didOpen(a){const l=a.querySelector("#countdown");t=setInterval(()=>{l.textContent=`${Math.ceil(f.getTimerLeft()/1e3)}`},1e3)},willClose(a){clearInterval(t)}}).then(async a=>{if(!a.isDenied)try{const l=await u.postSignIn(e);B.login(l.data.token)}catch(l){console.error("[login] error ==>",l),await d.alertError(u.parseError(l))}s.close()})}return(s,e)=>(h(),b("form",{class:"formControls",onSubmit:S(y,["prevent"])},[P,q,n(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value.email=t),class:"formControls_input",type:"email",id:"email",name:"email",placeholder:"請輸入 email",required:""},null,512),[[i,r.value.email]]),D,n(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.nickname=t),class:"formControls_input",type:"text",name:"name",id:"name",placeholder:"請輸入您的暱稱",required:""},null,512),[[i,r.value.nickname]]),L,n(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.password=t),class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",required:""},null,512),[[i,r.value.password]]),M,n(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>p.value=t),ref_key:"refRepeatPwd",ref:m,class:"formControls_input",type:"password",name:"repeatPwd",id:"repeatPwd",placeholder:"請再次輸入密碼",required:""},null,512),[[i,p.value]]),R,g(x(V),{to:{name:"login"},class:"formControls_btnLink"},{default:k(()=>[E("登入")]),_:1})],32))}};export{N as default};
